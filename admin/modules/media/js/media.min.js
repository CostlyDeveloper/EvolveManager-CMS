var $=jQuery.noConflict();jQuery(document).ready(function(h){var g="media";var i="modules/"+g+"/";lazyload();h(document).on("click touchstart",".delete_gallery",function(){var j=h(this).attr("data-id");var k="purple";h.confirm({title:lang.galleryDelete,content:lang.galleryDeleteContent,autoClose:"cancelAction|8000",icon:"fa fa-warning",type:k,escapeKey:true,buttons:{deleteUser:{text:lang.galleryDeleteConfirm,action:function(){var m=h("#moduleID").val();var l=h("#token_data");var n={moduleID:m,gallery_id:j};n=l.serialize()+"&"+h.param(n);h.ajax({type:"POST",url:i+"actions/delete_gallery.php",data:n,cache:false,success:function(o){h("#galtr_"+j).fadeOut();showMessage("success","","")},error:function(o){showMessage("error","","")}})}},cancelAction:function(){}}})});h(document).on("click touchstart","#add_new_gal",function(l){l.preventDefault();var k="btn-blue";var m=lang.commonCreateNew;var j="url:"+i+"confirmBox/add_gal.php";h.confirm({title:m,content:j,buttons:{formSubmit:{text:lang.commonCreateButton,btnClass:k,action:function(){var p=h("#moduleID").val();var o=h("#instance_name").val();var n=h("#token_data");var q={moduleID:p,name:o};q=n.serialize()+"&"+h.param(q);h.ajax({type:"POST",dataType:"json",url:i+"actions/add_gal.php",data:q,cache:false,success:function(r){showMessage("success","","");window.setTimeout(window.location.replace(r.load_new),500)},error:function(r){showMessage("error","","")}})}},cancel:function(){},},onContentReady:function(){}})});h(document).on("click touchstart",".edit_media",function(m){m.preventDefault();var l=h(this).closest(".media_image").attr("data-id");var k=h("#moduleID").val();var j=h("#token_data");var n={moduleID:k,media_id:l};n=j.serialize()+"&"+h.param(n);h.ajax({type:"POST",url:i+"actions/select_single_media.php",data:n,cache:false,success:function(o){h("#media_info_block").remove();h("#dynamic_media_siedebar_wrapper").prepend(o).fadeIn()},error:function(o){showMessage("error","","")}});return false});h(document).on("click touchstart","#submit_media_info button",function(l){l.preventDefault();var k=h("#moduleID").val();var j=h("#submit_media_info, #token_data");var m={moduleID:k};m=j.serialize()+"&"+h.param(m);h.ajax({type:"POST",url:i+"actions/submit_media_info.php",data:m,cache:false,success:function(n){showMessage("success","","")},error:function(n){showMessage("error","","")}});return false});h(document).on("click touchstart",".delete_media",function(n){n.preventDefault();var j=h(this).attr("id");if(j){var m=lang.confirmRemoveTitle;var k=lang.confirmRemoveText;var o=lang.confirmRemoveContent;var p="purple"}else{var m=lang.confirmDeleteTitle;var k=lang.confirmDeleteText;var o="";var p="red"}var l=h(this).closest(".media_image").attr("data-id");h.confirm({title:m,content:o,autoClose:"cancelAction|8000",icon:"fa fa-warning",type:p,escapeKey:true,buttons:{deleteUser:{text:k,action:function(){var r=h("#moduleID").val();var q=h("#token_data");var s={moduleID:r,media_id:l,if_gallery:j};s=q.serialize()+"&"+h.param(s);h.ajax({type:"POST",url:i+"actions/delete_media.php",data:s,cache:false,success:function(t){h("#add_into_specific").hide();h("#create_gallery_button").hide();h("#delete_selected_button").hide();h("#parentpic_"+l).fadeOut();h(".selected_img").each(function(){h(this).removeClass("selected_img")});h(".media_selected").each(function(){h(this).addClass("hidden")});showMessage("success","","")},error:function(t){showMessage("error","","")}})}},cancelAction:function(){}}})});h("#add_into_gallery").change(function(){if(h("#add_into_gallery").val()===""){h("#create_gallery_button_title").html(lang.createGallery)}else{h("#create_gallery_button_title").html(lang.addIntoGallery)}});h(document).on("click touchstart","#create_gallery_button",function(o){o.preventDefault();var l;if(h("#add_into_gallery").val()){var k=h("#add_into_gallery").val().split("|");var l=k[0];var m=k[1];var q=lang.confirmSupplementGallery;var j=lang.addingMediaInto+m;var n="btn-purple"}else{var n="btn-blue";var q=lang.confirmCreateGallery;var j='<div class="form-group"><label>'+lang.confirmEnterGalleryName+'</label><input type="text" placeholder="'+lang.confirmGalleryName+'" id="gallery_name" class="name form-control" required /></div>'}var p;h.confirm({title:q,content:j,buttons:{formSubmit:{text:lang.confirmSubmit,btnClass:n,action:function(){var u=this.$content.find(".name").val();if(!l){if(!u){h.alert(lang.ConfirmValidName);return false}}var s=h("#moduleID").val();var r=h("#create_gallery_form, #token_data");var t={moduleID:s,gallery_title:u,add_into_gallery:l};t=r.serialize()+"&"+h.param(t);h.ajax({type:"POST",dataType:"json",url:i+"actions/submit_new_gallery.php",data:t,cache:false,success:function(v){if(v.message=="err"){showMessage("error","",v.message,2000)}else{showMessage("success","","")}h(".media_selected").each(function(){h(this).addClass("hidden")});h(".selected_img").each(function(){h(this).removeClass("selected_img")});h("#create_gallery_button").hide();h("#add_into_specific").hide();h("#delete_selected_button").hide();h("#submit_new_gallery").empty();window.setTimeout(window.location.replace(v.load_gallery_url),500)},error:function(v){showMessage("error","","")}})}},cancel:function(){},},onContentReady:function(){}})});h(document).on("click touchstart",".media_image",function(k){k.preventDefault();h(this).closest(".thumbnail").toggleClass("selected_img");h(this).prev().toggleClass("hidden");var j=h(".selected_img").length;if(j>0){h("#create_gallery_button").fadeIn();h("#add_into_specific").fadeIn();h("#delete_selected_button").fadeIn()}else{h("#create_gallery_button").fadeOut();h("#add_into_specific").fadeOut();h("#delete_selected_button").fadeOut()}h("#submit_new_gallery").empty();h("#selected_media_nr").empty().append("("+j+")").fadeIn();h("#selected_media_del_nr").empty().append("("+j+")").fadeIn();h("#submit_new_gallery").append('<input type="hidden" name="total_media" value="'+j+'" />').show();h(".selected_img").each(function(){var l=h(this).attr("data-id");h("#submit_new_gallery").append('<input type="hidden" name="mediaid_'+l+'" value="'+l+'" />').show()})});var e=h("#moduleID").val();var b=h("input[name=userID").val();var c=h("input[name=token").val();var f=h("input[name=cpass").val();var a=h("input[name=rdts").val();h(".dropzone").dropzone({url:i+"actions/upload_media.php",params:{moduleID:e,userID:b,token:c,cpass:f,rdts:a},success:function(l,m){var j=JSON.parse(m);var k=j.filesrc;d=new Date();h(".art_img_admin").css("display","none");h(j.thumb).insertAfter("#media_wrapper_tagline")}});h(document).on("click touchstart","#copyToClipboard",function(j){j.preventDefault();copyToClipboard("#imgpath");h(function(){showMessage("success","",lang.messageCopyClp)})})});